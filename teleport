local Kavo = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Kavo.CreateLib("GHOST MAP V4 - PRO", "Midnight")

local Tab = Window:NewTab("Teleport & Map")
local Section = Tab:NewSection("Gelişmiş Işınlanma Sistemi")

-- IŞINLANMA MOTORU (LAGSIZ & ANTICHEAT SAFE)
local function safeTeleport(targetCFrame)
    local char = game.Players.LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local tweenService = game:GetService("TweenService")
        local info = TweenInfo.new(0.5, Enum.EasingStyle.Quad) -- 0.5 saniyede yağ gibi akar
        local tween = tweenService:Create(char.HumanoidRootPart, info, {CFrame = targetCFrame})
        tween:Play()
    end
end

-- HARİTA PANELİ (EKRANA ÖZEL ÇİZİM)
local MapGui = Instance.new("ScreenGui", game.CoreGui)
local MapFrame = Instance.new("Frame", MapGui)
MapFrame.Size = UDim2.new(0, 220, 0, 220)
MapFrame.Position = UDim2.new(0, 10, 0.5, -110)
MapFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
MapFrame.BorderSizePixel = 2
MapFrame.Visible = true

local Viewport = Instance.new("ViewportFrame", MapFrame)
Viewport.Size = UDim2.new(1, 0, 1, 0)
Viewport.BackgroundTransparency = 1

local Camera = Instance.new("Camera", Viewport)
Viewport.CurrentCamera = Camera
local Zoom = 400

-- HARİTAYA TIKLAYINCA IŞINLANMA
Viewport.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        local char = game.Players.LocalPlayer.Character
        if char then
            local root = char.HumanoidRootPart
            local mousePos = game:GetService("UserInputService"):GetMouseLocation()
            local relX = (mousePos.X - Viewport.AbsolutePosition.X) / Viewport.AbsoluteSize.X
            local relY = (mousePos.Y - Viewport.AbsolutePosition.Y) / Viewport.AbsoluteSize.Y
            
            local targetPos = root.Position + Vector3.new((relX - 0.5) * Zoom * 2.5, 0, (relY - 0.5) * Zoom * 2.5)
            safeTeleport(CFrame.new(targetPos + Vector3.new(0, 5, 0)))
        end
    end
end)

-- KAVO KONTROLLERİ
Section:NewSlider("Harita Zoom (Yükseklik)", "Haritayı genişletir/daraltır", 3000, 100, function(s)
    Zoom = s
end)

Section:NewButton("Haritayı Gizle/Aç", "M tuşu yerine butondan kontrol", function()
    MapFrame.Visible = not MapFrame.Visible
end)

Section:NewButton("Harita Renderını Yenile", "Harita değişirse bas", function()
    Viewport:ClearAllChildren()
    local World = Instance.new("WorldModel", Viewport)
    for _, v in pairs(game.Workspace:GetChildren()) do
        if v:IsA("BasePart") and v.Transparency < 1 then v:Clone().Parent = World end
    end
end)

-- KAMERA TAKİP DÖNGÜSÜ
game:GetService("RunService").RenderStepped:Connect(function()
    if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local p = game.Players.LocalPlayer.Character.HumanoidRootPart.Position
        Camera.CFrame = CFrame.new(p + Vector3.new(0, Zoom, 0), p)
    end
end)
